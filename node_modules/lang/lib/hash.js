/**
 * Created by IDE.
 * User: gzhang
 * Date: 11/5/11
 * Time: 10:50 PM
 * To change this template use File | Settings | File Templates.
 */


var crypto = require('crypto');
var algos = ["sha1", "md5", "sha256", "sha512", "ripemd160"];
var encoding = "hex";

algos.forEach(function(algo) {
    exports[ algo ] = function(data, salt) {
        var hash;
        if (typeof salt != 'undefined') {
            hash = crypto.createHmac(algo, salt).update(data).digest(encoding);
        }
        else {
            hash = crypto.createHash(algo).update(data).digest(encoding);
        }
        return hash;
    };
});