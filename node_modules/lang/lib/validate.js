/**
 * Created by IDE.
 * User: gzhang
 * Date: 11/5/11
 * Time: 7:23 PM
 * To change this template use File | Settings | File Templates.
 */


var lang = require('./lang.js');

module.exports = {
    // if obj match matcher, if not match will call func
    // assume obj.a not match matcher.a, then will call func('a', obj.a, matcher.a);
    // return true/false
    omatch: function(obj, matcher){
        var a,b;
        var mt=lang.typeOf(matcher), ot=lang.typeOf(obj);
        var self = arguments.callee;
        if(mt !== ot) return false;
        switch(mt){
            case "Date":
                return (obj.getTime() === matcher.getTime());
            case "Regex":
                return (obj.toString() === matcher.toString());
            case "Array":
                var i = matcher.length;
                if(obj.length < i) return false;
                for(;i--;){
                    if(!self(obj[i], matcher[i])) return false;
                }
                return true;
            case "Object":
                for(var p in matcher){
                    if(!self(obj[p], matcher[p])) return false;
                }
                return true;
            default:
                return (obj === matcher);
        }
    }
};